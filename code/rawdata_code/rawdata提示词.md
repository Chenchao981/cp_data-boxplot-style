晶圆厂CP测试数据在文件夹"E:/data/data2/rawdata"。测试用的源数据在项目相对路径"./data/data2/rawdata"存放的是用来测试程序都测试数据，用来调试程序。
要求根据rawdata的源数据，用python做数据清洗，数据分析，建模，然后根据图表的要素生成一个前端HTML展示的图表。
数据来源每个CP文件的"No.U"这一行。从字段"BVDSS1", "BVDSS2",	"DELTABV",	"IDSS1",	"VTH",	"RDSON1",	"VFSDS",	"IGSS2",	"IGSSR2",	"IDSS2".  每个字段生成一张独立的图，图的名称用字段名称作为标题，共10个，现在要求先完成"BVDSS1"的程序开发。"BVDSS1"字段数据来源该列下方的数据，第一列数字1和"BVDSS1"交叉的单元格就是需要的数值开始行，然后下方所有的。
log文件解读"头部信息:

Program name: 测试程序名称

Lot number: 批次号

Wafer number: 晶圆编号 (这里是1号晶圆)

Date, Time: 测试日期和时间

测试参数和上下限:

No.U: 测试项序号

X, Y: 晶圆上的坐标

Bin: 测试结果分类 (Pass/Fail 等)

CONT, IGSS0, IGSS1, ...: 各种电性能参数的测量值

LimitU, LimitL: 每个参数的规格上限和下限

Bias 1, Bias 2, ...: 测试时施加的偏置条件

测试数据:

每一行代表晶圆上一个特定位置（Die）的测试结果。

X, Y 坐标表示 Die 在晶圆上的位置。

各个电性能参数的测量值 （例如 BVDSS1, BVDSS2, VTH, RDSON1 ）等测量值"

图表要素分析：
    箱型图（Box Plot）和散点图（Scatter Plot）
{
    箱型图 (Box Plot - 蓝色箱体):  这是图表的核心部分。每个箱型图对应一个数据批次 (LOT)，通常代表一批晶圆片。 箱型图本身用来展示该批次内，特定测试参数的数值分布情况。  箱型图的主要构成元素包括：{箱体,须线,中位数线,异常值点}
    {
        箱体 (Box): 箱体的上下边缘分别代表数据的上四分位数（75th percentile）和下四分位数（25th percentile）。箱体内部包含了50%的数据。箱体的高度表示数据的四分位距（Interquartile Range, IQR），反映了数据中间部分的集中程度。
        中位数线 (Median Line - 箱体内部的线): 箱体内部的横线表示数据的中位数（50th percentile），即数据集中间位置的值。
        须线 (Whiskers - 箱体上下延伸的线): 须线从箱体的边缘延伸出去，通常表示数据的正常变动范围。 须线的长度通常由 IQR 的 1.5倍决定。超出须线范围的点通常被认为是异常值（Outliers）。
        异常值点 (Outlier Points - 箱体外面的点，图中未明显标出): 超出须线范围的点会被单独绘制成点，表示远离数据集中趋势的异常值。 
        散点图 (Scatter Plot - 棕色点):  棕色点叠加在箱型图之上，代表每个晶圆片 (WAFER)  在对应批次 (LOT) 下的个体测试数值。  这使得用户可以同时看到整体分布和个体数值。
        规格限制线 (USL/LSL - 红色虚线):  图表顶部标有 USL: 50.0 (上限规格LimitU)，底部标有 LSL: -10.0 (下限规格LimitL)。这两条红色的水平虚线代表了该测试参数的合格范围。  落在 USL 和 LSL 之间的数值被认为是合格的。USL和LSL信息来自于源数据的LimitU和LimitL字段信息。
    }
    
图表的表头
    {
        标题 (Title): 图表的标题，通常是 "Box Plot / VALUE"，文字居中显示
        PARAMETER:  参数名称 (Parameter：字段名称): 说明当前图表分析的是哪个字段的测试数据，这里是 "BVDSS1"。
    }

统计信息表格 (图表下方):  图表下方是一个表格，提供了每个"Wafer number"的统计信息，包括：
{
表格有4行：
    {
        - Average (平均值 - 蓝色数值): 每个批次数据值的平均数。
        - StdDev (标准差 - 棕色数值): 计算每个批次数据值的标准差。 
        - WAFER LOT(晶圆片编号: 表示每个批次内晶圆片的编号，一般从 01 到 25，取值来自于文件的"Wafer number"数值。这个值在"Wafer number"的右边。 批次的编号，一般从 01 到 25，水平排列。
        - 批次号数值：取自于源文件的"Lot number"字段数值，这个数值在"Lot number"字段数值的右边。格式是表格最后一行合并居中。
    }

    Parameter: 5:Delta BV (参数名称 - 图表上方右侧): 说明当前图表分析的是哪个 CP 测试参数，这里是 "5:Delta BV"。
    VALUE (Y轴标签 - 图表左侧垂直): Y轴标签 "VALUE" 表示纵轴代表的是测试参数的数值。
    Box Plot / VALUE (图表标题 - 图表上方中间): 图表标题 "Box Plot / VALUE" 说明了图表类型和所分析的数据。
    BV2-BV1 (标题左上角): 可能是更详细的测试条件或参数分组信息，例如 "BV2-BV1" 可能代表某种测试模式或设备设置。
    
    表格最下方的图例说明，固定放置图标：蓝色方块：VALUE， 红色三角形：Average。（如图）

图表x轴：取值在"LimitU"~"LimitL"从上到下
    LimitU：取值为当前"BVDSS1"和"Limit"交叉的单元格数值
    LimitL：取值为当前"BVDSS1"和"Limit"交叉的单元格数值

图表y轴："Wafer number"的取值，比如是01~25

}


数据解析:
这张图显示了 BVDSS1 参数在整个晶圆上的分布情况。

X 轴:

最下方标注了 LOT (批次) 和 WAFER (晶圆) 编号。

中间的数字 (01, 02, 03, ..., 25) 应该是晶圆上的列编号。

Y 轴: BVDSS1 的测量值。

箱线图:

每个箱线图概括了对应列上所有 Die 的 BVDSS1 值的统计分布（中位数、四分位数、异常值等）。

红色三角形代表平均值。

散点:

每个点代表一个 Die 的 BVDSS1 测量值。

散点的水平位置对应 Die 的 X 坐标（或列编号）。

散点的垂直位置对应 BVDSS1 的数值。

"宽度"的来源： 与第一张图类似，每个箱线图和周围的散点集合代表了晶圆上某一列 Die 的 BVDSS1 数据。由于绘图时，为了避免散点完全重叠，通常会在水平方向上给每个点添加一个小的随机偏移量（抖动，jitter），这就形成了"宽度"。
总结：如何生成宽度

数据选择: 从 log 文件中提取 BVDSS1 参数的数据。

分组:

按列分组 (推荐): 将所有 Die 按照 X 坐标（或列编号）分组。每个 X 坐标对应一组 BVDSS1 值。

不分组 (不推荐): 如果直接把所有 Die 的 BVDSS1 值画成散点，而不考虑 X 坐标，那么将无法体现出空间分布，也就没有"宽度"的概念了。

绘图:

对于按列分组的数据：

对每一列的 BVDSS1 值，计算统计量（如中位数、四分位数等）并绘制箱线图。

将每个 Die 的 BVDSS1 值作为散点绘制在对应列的箱线图周围。为了避免重叠，可以在水平方向上添加小的随机偏移（抖动）。

添加水平参考线（如规格下限 LSL: 660.0V）。

关键点
*"宽度"代表了晶圆上具有相同或相近 X 坐标（即同一列）的 Die 的 BVDSS1 值的集合。
*为了避免散点重叠，绘图时通常会在水平方向上添加小的随机偏移（抖动），从而产生了"宽度"。
*箱线图概括了每一列 Die 的 BVDSS1 值的统计分布。

X轴 (水平轴):  LOT (批次编号)。  X轴上的刻度表示不同的数据批次，从 LOT 01 一直到 LOT 25。

Y轴 (垂直轴):  VALUE (参数值)。 Y轴的数值范围根据 Delta BV 这个参数的实际数值范围自动调整，并标出了 USL (50.0) 和 LSL (-10.0)。

每个箱型图柱状:  每个箱型图柱状代表一个 LOT 的测试数据分布。例如，LOT 01 下面的箱型图就汇总了 LOT 01 批次中所有晶圆片在 "Delta BV" 参数上的测试数值的分布情况。

散点:  叠加在每个箱型图上的棕色散点，代表每个晶圆片在该批次下的具体的 "Delta BV" 测试数值。 散点的X轴位置与对应的箱型图 X轴位置一致 (LOT 编号)，Y轴位置就是该晶圆片的 "Delta BV" 测试值。

表格数据:  表格给出了每个 LOT 的 平均值 (Average) 和 标准差 (StdDev)。 例如，在 LOT 01 的列中，蓝色数字 "8.25" 就是 LOT 01 批次所有晶圆片 "Delta BV" 测试值的平均值， 棕色数字 "2.79" 就是 LOT 01 批次 "Delta BV" 测试值的标准差。
}

项目结构：
好的，为了实现您需要的晶圆厂CP数据分析图，并以HTML前端展示，我为您提供一个更详细的项目方案、技术框架、项目结构，以及用Python实现这个功能的代码框架和提示词。

项目方案：交互式晶圆厂CP数据分析HTML报告

1. 项目目标 (更具体化)

CP Log 文件解析: 能够准确解析您提供的CP测试log文件，即使文件格式可能稍有变化，程序也应具备一定的鲁棒性。
数据提取与转换: 从log文件中提取关键数据，例如晶圆片号 (Wafer Number)、测试参数值 (如 BVDSS1, IDSS1, DELTABV 等)，并转换为适合数据分析的格式。
多种图表生成:
散点图 (Scatter Plot): 展示每个晶圆片在特定测试参数下的数值，类似于之前的良率图，但这次是针对CP测试参数的Value。
箱型图 (Box Plot): 汇总展示同一批次 (Lot) 或所有晶圆片在特定测试参数下的数据分布情况，包括中位数、四分位数、异常值等，并叠加规格上下限 (USL/LSL) 线条。
交互式HTML报告: 将生成的散点图和箱型图嵌入到一个独立的HTML文件中。用户可以通过浏览器打开该HTML文件，并进行交互操作，例如：
参数选择: 允许用户在HTML报告中选择不同的测试参数 (如 BVDSS1, IDSS1 等)，图表能够动态更新以显示所选参数的数据。
数据点悬停: 当鼠标悬停在散点图或箱型图的数据点上时，显示详细的数据信息（例如，晶圆片号、参数值等）。
缩放与平移: 支持图表的缩放和平移，方便用户查看图表的细节。
统计信息展示: 在图表中或图表下方展示关键统计信息，如平均值 (Average)、标准差 (StdDev)、CPK/PPK (如果数据允许计算)。
规格限制 (USL/LSL) 可视化: 从log文件中提取或预设测试参数的规格上下限 (LimitU, LimitL)，并在箱型图中以线条的形式可视化 USL 和 LSL，帮助用户快速判断测试结果是否符合规范。
批次/晶圆片数据对比: (可选，如果时间允许) 允许用户选择不同的批次 (Lot) 或晶圆片 (Wafer) 进行数据对比分析。
2. 技术框架 (与之前类似，但更强调前端交互)

后端 (Python):
编程语言: Python 3.x
数据处理库: Pandas (核心数据处理和分析)
数值计算库: NumPy (Pandas 依赖)
图表库: Plotly (生成交互式图表，并导出HTML)
前端 (HTML/JavaScript):
HTML: 构建HTML页面结构，用于布局和展示图表、控件等。
CSS: 美化HTML页面样式 (可以使用 static/css/style.css)。
JavaScript: 实现前端交互功能，例如：
参数选择下拉菜单: 创建下拉菜单，让用户选择要查看的测试参数。
图表动态更新: 监听参数选择事件，当用户选择不同参数时，使用JavaScript动态更新Plotly图表的数据和标题。 (这部分如果时间有限，可以先简化为Python生成多个HTML文件，每个文件对应一个参数，不强求前端动态交互)
可选前端框架: 如果需要更复杂的前端交互，可以考虑使用轻量级的JavaScript框架，例如 Vue.js 或 React.js。但对于基本的数据展示和参数选择，原生JavaScript可能已经足够。
3. 项目结构 (模块化，更清晰的功能划分)

cp_analyzer_project/
├── data/                    # 存放CP测试 log 文件示例
├── scripts/                 # 存放 Python 脚本
│   ├── log_parser.py        # 负责解析 CP 测试 log 文件
│   ├── data_analyzer.py     # 数据分析和统计计算模块
│   ├── chart_generator.py   # 使用 Plotly 生成图表 (散点图和箱型图)
│   ├── html_report.py       # 生成 HTML 报告，整合图表和前端交互 (如果实现前端交互)
│   ├── main.py              # 主程序入口，控制程序执行流程
├── templates/               # 存放 HTML 模板文件 (如果使用模板引擎)
│   └── report_template.html
├── static/                  # 存放静态资源文件 (CSS, JavaScript)
│   ├── css/
│   │   └── style.css
│   └── js/
│   │   └── script.js
├── output/                  # 存放生成的 HTML 报告文件
├── README.md                # 项目说明文档
├── requirements.txt         # Python 依赖库列表

正式的源文件在"E:\ai_code\cp_analyzer_project\data\data2\rawdata"
测试用的源文件在项目文件夹"./data/data2/rawdata"
rawdata文件夹就是一个晶圆扩散批次，里面有一个晶圆扩散批，每片晶圆的CP测试数据。
数据的表头和格式如下：
Program name	ME58Y81_G0GC2AD.jtf																
Lot number	FA53-5465-305A-250303@203																
Wafer number	1																
Date	3/3/2025																
Time	00:11:11																
																	
No.U	X	Y	Bin	CONT	IGSS0	IGSS1	IGSSR1	BVDSS1	BVDSS2	DELTABV	IDSS1	VTH	RDSON1	VFSDS	IGSS2	IGSSR2	IDSS2
LimitU				0.500V	99.00uA	4.000uA	4.000uA	900.0V	900.0V	50.00-	250.0nA	4.000V	365.0mOHM	1.000V	300.0nA	300.0nA	200.0nA
LimitL				0V	0A	0A	0A	660.0V	660.0V	10.00-	0A	3.000V	100.0mOHM	0.000V	0A	0A	0A
Bias 1				1.00mA	1.00V	30.0V	30.0V	250uA	1.00mA	@008-	653V	250uA	1.00A	1.00A	20.0V	20.0V	600V
Bias 2										@007-			10.0V				
Bias 3								999V	999V								
Bias 4				2.50ms	40.0ms	40.0ms	40.0ms	20.0ms	10.0ms		20.0ms	2.50ms	1.00ms	2.00ms	40.0ms	40.0ms	20.0ms
Bias 5																	
Bias 6																	
1	41	5	1	0.00E+00	0.00E+00	5.51E-07	6.35E-07	7.17E+02	7.32E+02	1.46E+01	1.20E-08	3.43E+00	3.11E-01	7.66E-01	9.64E-08	8.55E-08	4.50E-09
2	47	5	9	0.00E+00	0.00E+00	6.13E-07	6.05E-07	6.68E+02	7.08E+02	3.94E+01	999.9						
3	53	5	3	0.00E+00	99.99												
4	47	7	1	0.00E+00	1.00E-08	5.36E-07	5.99E-07	7.50E+02	7.61E+02	1.11E+01	6.90E-09	3.33E+00	3.14E-01	7.63E-01	9.19E-08	8.09E-08	2.60E-09
5	47	9	1	0.00E+00	0.00E+00	6.46E-07	5.53E-07	7.56E+02	7.63E+02	6.80E+00	7.10E-09	3.30E+00	3.14E-01	7.62E-01	1.25E-07	7.62E-08	2.60E-09
6	23	11	1	0.00E+00	0.00E+00	4.69E-07	6.54E-07	7.51E+02	7.56E+02	5.70E+00	6.70E-09	3.45E+00	3.13E-01	7.64E-01	8.20E-08	7.89E-08	2.40E-09
7	29	11	1	0.00E+00	0.00E+00	4.57E-07	5.45E-07	7.70E+02	7.73E+02	3.30E+00	6.70E-09	3.35E+00	3.11E-01	7.64E-01	8.09E-08	7.01E-08	2.60E-09
8	35	11	1	0.00E+00	1.00E-08	5.32E-07	7.23E-07	7.65E+02	7.69E+02	3.70E+00	6.80E-09	3.35E+00	3.11E-01	7.63E-01	9.79E-08	1.09E-07	2.60E-09
9	41	11	1	0.00E+00	0.00E+00	4.81E-07	5.46E-07	7.56E+02	7.62E+02	6.20E+00	7.00E-09	3.32E+00	3.13E-01	7.63E-01	8.51E-08	7.44E-08	2.40E-09
10	47	11	1	0.00E+00	0.00E+00	4.90E-07	5.43E-07	7.53E+02	7.58E+02	5.20E+00	6.90E-09	3.30E+00	3.14E-01	7.63E-01	8.65E-08	7.30E-08	2.30E-09


------------------------------------迭代思路------------------------------------
1. 简化任务
    代码里面现在是["BVDSS1", "BVDSS2", "DELTABV", "IDSS1", "VTH","RDSON1", "VFSDS", "IGSS2", "IGSSR2", "IDSS2"],这么多参数一起分析，任务比较繁琐。现在简化任务，先分析"BVDSS1"，这一个参数的图表。调整代码
2.没有数据处理
    我看到输出的图表并没有数据。现在给你一些提示，你自己处理一下数据。
    1. x轴变量，参考LimitL 和LimitU的数据，选择合适的上下限数值有助于数据清洗显示

表格内容
 Average 	733.4	731	729.3	726.5	730.3	724.7	730	728.9	729.5	728.4	729.4	725.3	728.6	726.7	728.6	730.2	732	729.3	730.3	728.7	730.1	727.3	727.1	727.8	729.2
 StdDev 	10.87	11.51	12.09	11.81	11.59	12.52	11.52	12.09	12.07	11.72	11.14	11.71	11.3	12.79	11.71	12.25	11.15	11.45	11.56	11.51	11.78	12.32	12.05	11.54	10.59
 WAFER_LOT	1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25


图表已经差不多了。最下面的表格要修改下：1. 列转行显示  2. wafer lot 要合并成一个单元格,并把名称改成 WAFER_LOT。 帮我优化

-----------------数据清洗功能提示词分割线start------------------

win11系统下"E:\data"文件夹文件结构为
"
E:.
├─data1
│  ├─rawdata
│  └─summary
└─data2
    ├─rawdata
    ├─reports
    └─summary
"


data是存放数据的文件夹，文件夹下data1和data2是批次1和批次2. rawdata是其中一个批次的测试文件夹，存放晶圆厂CP测试文件的内容。每个文件的格式都类似于我之前代码示例。

我的目标是对每个文件中以下10个参数的数据进行批次分析：
"
BVDSS1
BVDSS2
DELTABV
IDSS1
VTH
RDSON1
VFSDS
IGSS2
IGSSR2
IDSS2
"

对于每个参数，请从数据部分的第一行开始提取数据。数据部分以包含列名的行为开头，例如 "No.U X Y Bin CONT IGSS0 ..."。你需要找到 "No.U" 列中值为整数 "1" 的行，然后从该行开始，提取指定参数列中的所有数值数据，直到文件结束。

清分析rawdata文件夹下的所有log文件，对于一个批次的数据进行分析整合，一个批次的所有log文件的每个参数生成一个JSON格式的源文件。
json包含的必要字段，根据之前编写的代码进行汇总。必要的字段包括
"Lot number,
Wafer number,
No.U,
LimitU,
LimitL,
"

针对这个数据清洗输出json格式的需求，请设计对应的目录结构，相关代码，方便程序读写
-----------------数据清洗功能提示词分割线end------------------

----------------数据微调start----------------
"
IDSS1,
IGSS2，
IGSSR2，
IDSS2,
"
4个参数的单位均为nA。要求：
1. 纵坐标也应调整为nA单位。
2. 由于是nA（1nA = 0.000000001A），在单元格里面把'e-9'取消，保留nA的单位，比如'6.80E-09'取6.80放在表格中。
3.对这4个参数进行调整。其他参数精度保留上个版本的精度，不需要强制精确到小数点后2位，以方便表格展示

----------------数据微调end----------------

----------------多批次分析功能提示词start----------------
1. 调整rawdata的文件夹位置，当前位置为“E:\data\rawdata”
2. “E:\data\rawdata”文件夹下有多个批次的文件夹，每个批次文件夹下有多个log文件。 
3. rawdata文件夹下有多个批次的文件夹，文件夹名称如下
{
    E:\data\rawdata\
    ├─NCEHSM650PBA_C127251.00@CP
    ├─NCEHSM700TCB_C146419.00@CP
    ├─NCESF600RAA_FA51-3283@203
    └─NCESM650QAA_FA49-2230@203
}
4. 保持每个批次的文件夹分析结构不变，代码逻辑不变，前端样式一样，生成4个文件夹对应的4套图表需求。
5. 每个文件夹的json文件为一套，json新建对应的文件夹，里面10个参数的json
6. 先输出一版，让我验证效果
----------------多批次分析功能提示词end----------------

---------------------数据单位调整start---------------------
增加数据单位调整功能模块
要求：根据LimitU的单位和数值，确定下面的数值的单位，然后进行单位转换。
数据源文件的单位原则：下面数值的单位一般都是标准单位，A,V,Ω
LimitU的单位就是源文件里面获取的，LimitL的单位是LimitU的单位，LimitU的数值和LimitL的数值不变。
一般源文件相关字段的数值90%以上都是在LimitL和LimitU数值区间内，可以这个确认转换逻辑。比如上限10，下限0，那么这个字段的数据都是0-10之间，那么这个字段的数据单位就是A，如果源文件里面是0.005，那么就转换为5。
以下是具体的字段和单位
1.IDSS1 的值- 有可能需要从安培(A)转换为纳安(nA)，乘以10^9
2.IGSS2 的值- 有可能需要从安培(A)转换为纳安(nA)，乘以10^9
3.IGSSR2 的值- 有可能需要从安培(A)转换为纳安(nA)，乘以10^9
4.IDSS2 的值- 有可能需要从安培(A)转换为纳安(nA)，乘以10^9
5.IDSS3 的值- 可能需要从安培(A)转换为微安(μA)，乘以10^6
6.RDSON1的值- 有可能需要从欧姆(Ω)转换为毫欧(mΩ)，乘以1000
7.VFSDS的值- 可能需要从伏特(V)转换为毫伏(mV)，乘以1000
8.BVDSS1的值- 可能需要从伏特(V)转换为毫伏(mV)，乘以1000
9.BVDSS2的值- 可能需要从伏特(V)转换为毫伏(mV)，乘以1000
10.DELTABV的值- 可能需要从伏特(V)转换为毫伏(mV)，乘以1000


其中源文件地址参考："E:\data\rawdata\NCEHSM650PBA_C127251.00@CP\NCEHSM650PBA_C127251.00@CP_001.log"
文件结构{E:\data\rawdata，rawdata文件夹下有多个批次的文件夹，每个批次文件夹下有多个log文件}。
---------------------数据单位调整end---------------------